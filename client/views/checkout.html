<!-- NAVBAR (SEE ABOUTUS.HTML, STILL UNDER EDIT, COPY & PASTE UPON COMPLETION) -->


<!-- CHECKOUT CONTROLLER -->
<div class="page-header row">
    <h1 class="col-md-12">CHECKOUT</h1>
</div>
<!-- CART CONTROLLER BINDING -->
<div ng-repeat="s in shoppingCart">
    <img src="{{ s.imageurl }}" width="300" height="300" ng-href="/checkout">
    <h3>{{ s.title }}</h3>
    <p>{{ s.price }}</p>
</div>

<div ng-controller="CheckoutController">
    <!-- html form -->
    <form action="charge()">
        <label class="item item-input">
            <span class="input-label">Card number</span>
            <input type="text" size="20" ng-model="FormData.number" placeholder="4242 4242 4242 4242" />
        </label>

        <label class="item item-input">
            <span class="input-label">Exp. Mth (MM)</span>
            <input type="text" size="2" ng-model="FormData.exp_month">
        </label>

        <label class="item item-input">
            <span class="input-label">Exp. Year (YYYY)</span>
            <input type="text" size="4" ng-model="FormData.exp_year">
        </label>

        <label class="item item-input">
            <span class="input-label">Sec. Code (CVC)</span>
            <input type="text" size="4" ng-model="FormData.cvc">
        </label>
    </form>
</div>

<div class="padding center">
    <button class="button button-block button-balanced" ng-click="processPurchase()">Submit</button>
</div>
<!-- Stripe button -->
<button class="pay">Pay</button> -->

<script src="https://checkout.stripe.com/checkout.js">
<script>
    var handler = StripeCheckout.configure({
      key: window.STRIPE_PUBLICK_KEY,
      image: 'https://yourlogo.png',
      locale: 'auto',
      token: function(token) {
        $('.pay').prop("disabled", true);
        $('.pay').text('Paying...')
        $.ajax({
            url: 'https://webtask.it.auth0.com/your-account/stripe',
            type: 'POST',
            data: {
              stripeToken: token.id
            }
        }).then(function(stripeCustomer) {
          console.log('success');
        }).fail(function(e) {
          $('.pay').text('Buy');
          alert('There was an error processing the payment. Please try again.')
        });
      }
    });
    
    $(function() {
      $('.pay').on('click', function(e) {
        e.preventDefault();
        handler.open({
          name: 'Title',
          description: 'My Subscription',
          panelLabel: "Subscribe",
          amount: 900, // 9 usd
          email: 'default_email_if_you_have_it',
          allowRememberMe: false
        });
      });
    });
    
    
    // close Checkout on page navigation
    $(window).on('popstate', function() {
      handler.close();
    });
</script>
// end stripe button//