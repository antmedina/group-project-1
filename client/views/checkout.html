<!-- NAVBAR (SEE ABOUTUS.HTML, STILL UNDER EDIT, COPY & PASTE UPON COMPLETION) -->


<!-- CHECKOUT CONTROLLER -->
<div class="page-header row">
    <h1 class="col-md-12">CHECKOUT</h1>
</div>
<!-- CART CONTROLLER BINDING -->
<div ng-controller="CheckoutController" ng-repeat="c in cart">
    <img src="{{ c.imageurl }}" width="300" height="300" ng-href="/checkout">
    <h3>{{ c.title }}</h3>
    <p>{{ c.price }}</p>
</div>

<div ng-controller="CheckoutController">
    <!-- html form -->
    <form action="charge()">
        <label class="item item-input">
            <span class="input-label">Card number</span>
            <input type="text" size="20" ng-model="FormData.number" placeholder="4242 4242 4242 4242" />
        </label>

        <label class="item item-input">
            <span class="input-label">Exp. Mth (MM)</span>
            <input type="text" size="2" ng-model="FormData.exp_month">
        </label>

        <label class="item item-input">
            <span class="input-label">Exp. Year (YYYY)</span>
            <input type="text" size="4" ng-model="FormData.exp_year">
        </label>

        <label class="item item-input">
            <span class="input-label">Sec. Code (CVC)</span>
            <input type="text" size="4" ng-model="FormData.cvc">
        </label>
    </form>
</div>

<div class="padding center">
    <button class="button button-block button-balanced" ng-click="processPurchase()">Submit</button>
</div>

<!-- stripe attempt -->
<body>
<p id="total">0.5</p>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="https://checkout.stripe.com/checkout.js"></script>

  <a id="pay" href="#">Pay</a>

  <script>
      var amount = document.getElementById('total').innerHTML * 100;
      // Define handler to be called when Stripe returns a card token
      function onReceiveToken(token, args) {
          // Submit token to server so it can charge the card
          $.post( "/charge", {stripeToken: token.id, amount: amount})
            .done(function( data ) {
              console.log( "Data Loaded: " + data );
              // show cart after adding item
              window.document.location = "../success";
            });
      }
      // Configure Checkout
      var checkout = StripeCheckout.configure({
          key: 'pk_test_9tsmwEEJjb9Borudu22ms6am',
          token: onReceiveToken,
          image: 'https://nairteashop.org/wp-content/uploads/avatar.png',
          name: 'BookFront',
          description: 'support your bookstore',
          amount: amount,
          billingAddress: false
      });
      // Open Checkout when the link is clicked
      $('#pay').on('click', function() {
          checkout.open();
          return false;
      });
  </script>
  </body>
<!-- end attempt -->